Q&A
======

BSS段
-------

BSS段BSS段bss segment通常是指用来存放程序中未初始化的全局变量的一块内存区域BSS是英文Block Started by Symbol的简称BSS段属于静态内存分配

数据段数据段data segment通常是指用来存放程序中已初始化的全局变量的一块内存区域数据段属于静态内存分配

代码段代码段code segment/text segment通常是指用来存放程序执行代码的一块内存区域这部分区域的大小在程序运行前就已经确定并且内存区域通常属于只读, 某些架构也允许代码段为可写即允许修改程序在代码段中也有可能包含一些只读的常数变量例如字符串常量等

堆heap堆是用于存放进程运行中被动态分配的内存段它的大小并不固定可动态扩张或缩减当进程调用malloc等函数分配内存时新分配的内存就被动态添加到堆上堆被扩张当利用free等函数释放内存时被释放的内存从堆中被剔除堆被缩减若程序员不释放则会有内存泄漏系统会不稳定Windows系统在该进程退出时由OS释放Linux则只在整个系统关闭时OS才去释放参考Linux内存管理

栈(stack)栈又称堆栈 是用户存放程序临时创建的局部变量也就是说我们函数括弧{}中定义的变量但不包括static声明的变量static意味着在数据段中存放变 量除此以外在函数被调用时其参数也会被压入发起调用的进程栈中并且待到调用结束后函数的返回值也会被存放回栈中由于栈的先进先出特点所以 栈特别方便用来保存/恢复调用现场从这个意义上讲我们可以把堆栈看成一个寄存交换临时数据的内存区

它是由操作系统分配的内存的申请与回收都由OS管理

PS

全局的未初始化变量存在于.bss段中具体体现为一个占位符全局的已初始化变量存 于.data段中而函数内的自动变量都在栈上分配空间.bss是不占用.exe文件空间的其内容由操作系统初始化清零而.data却需要占 用其内容由程序初始化因此造成了上述情况

bss段未手动初始化的数据并不给该段的数据分配空间只是记录数据所需空间的大小

data已手动初始化的数据段则为数据分配空间数据保存在目标文件中 数据段包含经过初始化的全局变量以及它们的值BSS段的大小从可执行文件中得到 然后链接器得到这个大小的内存块紧跟在数据段后面当这个内存区进入程序的地址空间后全部清零包含数据段和BSS段的整个区段此时通常称为数据区

